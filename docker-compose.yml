version: "2"

services:
    app:
        build: ./
        volumes:
            - ./:/usr/src/app
        ports:
            - "3000:3000"
        links:
            - mongodb
        environment:
            - API_KEY
            - API_SECRET
            - WS_PORT
            - HTTP_PORT
            - DB_USER
            - DB_PASS
            - DB_HOST
            - DB_PORT
            - DB_NAME
    data:
        image: 'ubuntu'
        volumes:
            - /var/lib/mysql:/var/lib/mysql
            - /var/lib/postgres:/var/lib/postgres
            - /var/lib/mariadb:/var/lib/mariadb
            - /var/lib/memcached:/var/lib/memcached
            - /var/lib/redis:/data
            - /var/lib/neo4j:/var/lib/neo4j/data
            - /var/lib/mongo:/data/db
        command: ["true"]

    mongodb:
        image: mongo
        expose:
            - "3306"
        volumes_from:
            - data
        ports:
            - "27017:27017"
        environment:
            - MONGODB_USER=app_user
            - MONGODB_PASS=password
            - MONGODB_DATABASE=notifications
